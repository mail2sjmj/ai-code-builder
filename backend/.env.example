# ─── AI Code Builder — environment configuration template ────────────────────
#
# Each environment has its own FULLY SELF-CONTAINED config file.
# No settings are inherited from a shared base — every key is explicit here.
#
# SETUP:
#   Copy this file to the environment you need and fill in real values:
#     cp .env.example .env.development    # local dev
#     cp .env.example .env.staging        # staging server
#     cp .env.example .env.production     # production server
#
#   Then set APP_ENV in the base selector file:
#     echo "APP_ENV=development" > .env
#
# CONFIG LOAD ORDER (later source wins):
#   1. Built-in field defaults      (settings.py)
#   2. .env                         APP_ENV selector only  (gitignored)
#   3. .env.<APP_ENV>               full environment config (gitignored)
#   4. .env.<APP_ENV>.local         personal local tweaks   (gitignored)
#   5. OS environment variables                             (always win)
#
# All .env.* files are gitignored — they contain secrets.
# Only .env.example is committed to source control.

# ─── Application ──────────────────────────────────────────────────────────────
APP_ENV=development                 # development | staging | production
APP_VERSION=1.0.0
API_PREFIX=/api/v1

# ─── CORS ─────────────────────────────────────────────────────────────────────
# development:  ["http://localhost:5173","http://localhost:3000","http://localhost:80"]
# staging:      ["https://staging.your-domain.com","http://localhost:80"]
# production:   ["https://your-domain.com"]
ALLOWED_ORIGINS=["http://localhost:5173","http://localhost:3000","http://localhost:80"]

# ─── File Upload ──────────────────────────────────────────────────────────────
MAX_UPLOAD_SIZE_MB=50
ALLOWED_EXTENSIONS=[".csv",".xlsx"]

# INBOUND_DIR: where uploaded files and parquet caches are stored.
# Auto-resolved via tempfile.gettempdir() if not set.
# Use a persistent, backed-up volume in staging/production.
#   Unix/macOS: INBOUND_DIR=/var/data/code_builder/inbound
#   Windows:    INBOUND_DIR=C:\data\code_builder\inbound
# INBOUND_DIR=

SESSION_TTL_SECONDS=3600            # seconds; tune per environment

# ─── Sandbox Execution ────────────────────────────────────────────────────────
# TEMP_DIR: where ephemeral sandbox artifacts are written.
# Auto-resolved via tempfile.gettempdir() if not set.
# Can point to a fast local disk separate from INBOUND_DIR.
#   Unix/macOS: TEMP_DIR=/var/tmp/code_builder/sessions
#   Windows:    TEMP_DIR=C:\Temp\code_builder\sessions
# TEMP_DIR=

SANDBOX_TIMEOUT_SECONDS=30          # seconds; tune per environment
SANDBOX_MAX_MEMORY_MB=512
SANDBOX_MAX_OUTPUT_ROWS=100000
PREVIEW_ROW_COUNT=50

# ─── Logging ──────────────────────────────────────────────────────────────────
# LOG_DIR: directory for rotating log files (app.<APP_ENV>.log).
# Auto-resolved via tempfile.gettempdir() if not set.
# Use a centrally-monitored path in staging/production.
#   Unix/macOS: LOG_DIR=/var/log/code_builder
#   Windows:    LOG_DIR=C:\Logs\code_builder
# LOG_DIR=

LOG_LEVEL=INFO                      # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_MAX_BYTES=10485760              # 10 MB per file before rotation
LOG_BACKUP_COUNT=5                  # number of rotated files to retain

# ─── Service Management (manage.py) ───────────────────────────────────────────
HEALTH_CHECK_RETRIES=20             # max attempts before declaring startup failed
HEALTH_CHECK_INTERVAL_SECONDS=1     # seconds to wait between each retry

# ─── Anthropic AI — REQUIRED ──────────────────────────────────────────────────
ANTHROPIC_API_KEY=sk-ant-...        # get from console.anthropic.com
ANTHROPIC_MODEL=claude-sonnet-4-6
REFINE_MAX_TOKENS=2048
CODEGEN_MAX_TOKENS=8192
AI_TEMPERATURE=0.2
AI_REQUEST_TIMEOUT_SECONDS=120
AI_MAX_RETRIES=5                # retries on 429 / 529 overloaded errors  (0 = disabled)
